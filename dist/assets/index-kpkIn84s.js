(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const e of o)if(e.type==="childList")for(const a of e.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function i(o){const e={};return o.integrity&&(e.integrity=o.integrity),o.referrerPolicy&&(e.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?e.credentials="include":o.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function s(o){if(o.ep)return;o.ep=!0;const e=i(o);fetch(o.href,e)}})();class Y{constructor(t,i,s,o){this.posX=t,this.posY=i,this.color=s,this.ocupado=o}draw(t,i){t.strokeStyle="white",t.lineWidth=1,t.strokeRect(this.posX*i,this.posY*i,i,i)}static drawCasillas(t,i,s,o){t.forEach(e=>{o.fillStyle=e.color,o.fillRect(e.posX*i,e.posY*i,s,s)})}}function z(r){if(r.length===0)return null;const t=Math.floor(Math.random()*r.length);return r[t]}function u(r,t){return Math.floor(Math.random()*(t-r)+r)}class b{constructor(t,i,s,o,e){this.posX=t,this.posY=i,this.colum=s,this.filaRight=o,this.filaLeft=e,this.drop=["right","up","left","down"],this.inUse=!0}isFinish(t,i,s){if(this.posY+this.colum>=s-1)return!0;for(let o=0;o<i.length;o++){const e=i[o][0],a=i[o][1]+1;if(t.some(X=>X.posX==e&&X.posY==a))return!0}}obtenerCasillasDibujo(t){this.filaRight=0,this.filaLeft=0,this.colum=0;let i=[];return t.forEach(s=>{const o=s[0][0],e=s[0][1];if(this.drop[s[1]]=="right")for(let a=0;a<s[2];a++)i.push([o+a,e]),this.filaRight=a;else if(this.drop[s[1]]=="up")for(let a=0;a<s[2];a++)i.push([o,e-a]);else if(this.drop[s[1]]=="left")for(let a=0;a<s[2];a++)i.push([o-a,e]),this.filaLeft=a;else for(let a=0;a<s[2];a++)i.push([o,e+a]),this.colum=a}),i}drawCasillas(t,i,s,o,e){t.forEach(a=>{e.fillStyle=i,e.fillRect(a[0]*s,a[1]*s,o,o)})}update(t,i,s,o){this.posX+=t,this.posY+=i,this.posX+this.filaRight>=o-1&&(this.posX=o-1-this.filaRight),this.posX-this.filaLeft<=0&&(this.posX=0+this.filaLeft),this.posY+this.colum>=s-1&&(this.posY=s-1-this.colum)}}class L extends b{constructor(t,i,s,o,e){super(t,i,s,o,e),this.count=[0,0,0,3],this.dibujado=[[[t,i],this.count[0],3],[[t,i+1],this.count[1],3],[[t,i+2],this.count[2],3],[[t,i],this.count[3],3]]}update(t,i,s,o){super.update(t,i,s,o),this.actualizarDibujo()}actualizarDibujo(){this.dibujado=[[[this.posX,this.posY],this.count[0],3],[[this.posX,this.posY+1],this.count[1],3],[[this.posX,this.posY+2],this.count[2],3],[[this.posX,this.posY],this.count[3],3]]}rotarDibujo(){}}class k extends b{constructor(t,i,s,o,e){super(t,i,s,o,e),this.count=[3],this.dibujado=[[[t,i],this.count[0],5]]}update(t,i,s,o){super.update(t,i,s,o),this.actualizarDibujo()}actualizarDibujo(){this.dibujado=[[[this.posX,this.posY],this.count[0],5]]}rotarDibujo(){this.count=this.count.map(t=>(t++,t>3?0:t)),this.actualizarDibujo}}class x extends b{constructor(t,i,s,o,e){super(t,i,s,o,e),this.count=[3,0,2],this.dibujado=[[[t,i],this.count[0],3],[[t,i],this.count[1],2],[[t,i],this.count[2],2]]}update(t,i,s,o){super.update(t,i,s,o),this.actualizarDibujo()}actualizarDibujo(){this.dibujado=[[[this.posX,this.posY],this.count[0],3],[[this.posX,this.posY],this.count[1],2],[[this.posX,this.posY],this.count[2],2]]}rotarDibujo(){this.count=this.count.map(t=>(t++,t>3?0:t)),this.actualizarDibujo}}class C extends b{constructor(t,i,s,o,e){super(t,i,s,o,e),this.count=[3,2],this.dibujado=[[[t,i],this.count[0],2],[[t,i],this.count[1],2]]}update(t,i,s,o){super.update(t,i,s,o),this.actualizarDibujo()}actualizarDibujo(){this.dibujado=[[[this.posX,this.posY],this.count[0],2],[[this.posX,this.posY],this.count[1],2]]}rotarDibujo(){this.count=this.count.map(t=>(t++,t>3?0:t)),this.actualizarDibujo}}class A extends b{constructor(t,i,s,o,e){super(t,i,s,o,e),this.count=[3,2],this.dibujado=[[[t,i],this.count[0],3],[[t,i],this.count[1],2]]}update(t,i,s,o){super.update(t,i,s,o),this.actualizarDibujo()}actualizarDibujo(){this.dibujado=[[[this.posX,this.posY],this.count[0],3],[[this.posX,this.posY],this.count[1],2]]}rotarDibujo(){this.count=this.count.map(t=>(t++,t>3?0:t)),this.actualizarDibujo}}function v(r){const t=z(r);return t=="cuadrado"?new L(u(3,12),u(-5,0),2,2,0):t=="varilla"?new k(u(0,15),u(-5,0),4,0,0):t=="T"?new x(u(2,13),u(-5,0),2,1,1):t=="lPequena"?new C(u(2,13),u(-5,0),1,0,1):new A(u(2,13),u(-5,0),2,0,1)}function B(r,t,i){return r.forEach(s=>{const o=s.posX,e=s.posY;t.some(a=>a[0]==o&&a[1]==e)&&i.push(new Y(s.posX,s.posY,"green",!0))}),i}function P(r,t,i){let s=r-1;for(;s!=0;)t.filter(e=>e.posY==s).length==i?(t=t.filter(e=>e.posY!=s),console.log(t),t.forEach(e=>{e.posY<s&&(e.posY=e.posY+1)})):s--;return t}const c={velocidadX:0,velocidadY:0,velocidadYBajada:1};function F(r,t,i){switch(r.code){case"ArrowDown":t.velocidadY=1;break;case"ArrowLeft":t.velocidadX=-1;break;case"ArrowRight":t.velocidadX=1;break;case"Space":i.rotarDibujo();break}}function q(r,t){(r.key==="Escape"||r.keyCode===27)&&(t.velocidadYBajada=t.velocidadYBajada==0?1:0)}const w=document.querySelector("canvas"),l=w.getContext("2d"),j=400,h=18,p=16,f=j/h,D=j/h;w.width=f*p;w.height=f*h;const y=["cuadrado","varilla","T","lPequena","lGrande"];let n=v(y),m=v(y),g=[],d=[];for(let r=0;r<h;r++)for(let t=0;t<p;t++)g.push(new Y(t,r,"green",!1));document.addEventListener("keydown",r=>{F(r,c,n)});document.addEventListener("keydown",r=>{q(r,c)});document.getElementById("bt-d").addEventListener("click",()=>c.velocidadY=1);document.getElementById("bt-r").addEventListener("click",()=>c.velocidadX=1);document.getElementById("bt-l").addEventListener("click",()=>c.velocidadX=-1);document.getElementById("rotate").addEventListener("click",()=>n.rotarDibujo());function E(){n.update(c.velocidadX,c.velocidadY,h,p),l.fillStyle="black",l.fillRect(0,0,j,j);const r=n.obtenerCasillasDibujo(n.dibujado);n.drawCasillas(r,"red",f,D,l),Y.drawCasillas(d,f,D,l),g.forEach(t=>t.draw(l,f)),c.velocidadX=0,c.velocidadY=0,n.isFinish(d,r,h)&&(n=m,m=v(y),d=B(g,r,d),d=P(h,d,p)),requestAnimationFrame(E)}E();setInterval(()=>n.update(0,c.velocidadYBajada,h,p),1e3);
